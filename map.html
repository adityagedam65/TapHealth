<!DOCTYPE html>
<html>
<head>
<title>Nearby Hospitals ‚Äì TapHealth</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link
  rel="stylesheet"
  href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
/>

<style>
body{
    margin:0;
    font-family: system-ui;
    background:#f8fafc;
}

.header{
    padding:14px;
    font-size:18px;
    font-weight:700;
    background:white;
    box-shadow:0 1px 10px rgba(0,0,0,.05);
}

#map{
    height:calc(100vh - 60px);
    width:100%;
}
</style>
</head>

<body>
<div class="header">üè• Hospitals Near You</div>
<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
navigator.geolocation.getCurrentPosition(pos => {
    const lat = pos.coords.latitude;
    const lon = pos.coords.longitude;

    const map = L.map("map").setView([lat, lon], 14);

    // Map tiles
    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
        maxZoom: 19
    }).addTo(map);

    // Blue YOU marker
    const youIcon = L.icon({
        iconUrl: "https://maps.google.com/mapfiles/ms/icons/blue-dot.png",
        iconSize: [32, 32]
    });

    L.marker([lat, lon], {icon: youIcon})
        .addTo(map)
        .bindPopup("You are here")
        .openPopup();

    // Red Hospital icon
    const hospitalIcon = L.icon({
        iconUrl: "https://maps.google.com/mapfiles/ms/icons/red-dot.png",
        iconSize: [32, 32]
    });

    // Fetch nearby hospitals from OpenStreetMap
    fetch(`https://overpass-api.de/api/interpreter?data=[out:json];
      (node["amenity"="hospital"](around:5000,${lat},${lon});
       way["amenity"="hospital"](around:5000,${lat},${lon}););
      out center;`)
    .then(res => res.json())
    .then(data => {
        data.elements.forEach(place => {
            const pLat = place.lat || place.center.lat;
            const pLon = place.lon || place.center.lon;

            L.marker([pLat, pLon], {icon: hospitalIcon})
              .addTo(map)
              .bindPopup("üè• " + (place.tags.name || "Hospital"));
        });
    });
});
</script>

</body>
</html>
